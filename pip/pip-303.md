# Motivation

We have a scenario that uses the `org.apache.pulsar.broker.intercept.BrokerInterceptor#messageProduced`, and need to
obtain the message metadata, but the `org.apache.pulsar.broker.service.Topic.PublishContext` doesn't provide this data.

# Goals

## In Scope

Make `org.apache.pulsar.broker.service.Topic.PublishContext` to provide the message metadata.

# Detailed Design

## Design & Implementation Details

1. Add `getHeaderAndPayload()` to `org.apache.pulsar.broker.service.Topic.PublishContext` to obtain the message metadata:

```java
public interface Topic {
    interface PublishContext {
        default ByteBuf getHeaderAndPayload() {
            return null;
        }
    }
}
```

2. Override `getHeaderAndPayload()` in `org.apache.pulsar.broker.service.Producer.MessagePublishContext`.

# Backward & Forward Compatibility

## Revert

This should be considered a bug, so cherry-pick is needed.

- branch-2.10
- branch-2.11
- branch-3.0
- branch-3.1

## Upgrade

None.

# Alternatives

None.

# General Notes

# Links

* Mailing List discussion thread:
* Mailing List voting thread:
